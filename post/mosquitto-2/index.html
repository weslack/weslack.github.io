<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.82.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>Mosquitto Flag 2&nbsp;&ndash;&nbsp;weslack</title><link rel=stylesheet href=/css/core.min.ef607fd3ec4a0f4af353d3e9b3a1dc7611964c7c8183a173506541206fada2e3848afb5f470cffc866df3a3cd534c4ea.css integrity=sha384-72B/0+xKD0rzU9Pps6HcdhGWTHyBg6FzUGVBIG+touOEivtfRwz/yGbfOjzVNMTq><meta name=twitter:card content="summary"><meta name=twitter:title content="Mosquitto Flag 2"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><img class="site logo" src=/logo.png alt><span class="site name">weslack</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>Categories</a><a class="nav item" href=/tags/>Tags</a><a class="nav item" href=/about/>About</a><a class="nav item" href=https://github%2ecom/weslack target=_blank>GitHub</a></nav></div></span></div><div class="site slogan"><span class=title>CTF Fun and Write Ups</span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">Mosquitto Flag 2</h1><p class="article date">Sat, 24 Apr 2021 09:41:43</p></section><article class="article markdown-body"><h2 id=challenge>Challenge</h2><p>See if you have the patience to scratch the itch; patience is key. Mosquitto bites are so annoying! Except, in this case.. you can become an admin. Connect at: x.x.x.x:1883 using iot:iot Web Portal: <a href=http://x.x.x.x>http://x.x.x.x</a></p><h2 id=solve>Solve</h2><p>Look at the new Mosquitto server, connecting using the following command</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>mosquitto_sub -h x.x.x.x -p <span class=m>1883</span> -u iot -P iot -t <span class=s2>&#34;#&#34;</span>
</code></pre></div><p>Grab the text that looks like a flag.</p><p>Base64 decode the username and password.</p><p>Grab the giant base64 string that looks a lot like an image and look a the file header. Realize it is an image. Turn it into a file.</p><p>Try to use it, realize it is an actual OTP and do it all again quickly.</p><p>Use the credentials to get the flag.</p></article><section class="article labels"><a class=category href=/categories/iot-village/>IoT Village</a><a class=tag href=/tags/mosquitto/>Mosquitto</a><a class=tag href=/tags/base64/>Base64</a></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/post/black-box-1-flag/><span class="iconfont icon-article"></span>Black Box 1 Flag Writeup</a></p></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>All content is free, unencumbered, and released into the public domain. Do with it what you want. <a href=/LICENSE.txt>Unlicense</a></p><p class=powerby><span>Powered&nbsp;by&nbsp;</span><a href=https://gohugo.io target=_blank>Hugo</a><span>&nbsp;&&nbsp;</span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section></body></html>