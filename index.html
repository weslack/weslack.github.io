<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.82.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>weslack&nbsp;&ndash;&nbsp;CTF Fun and Write Ups</title><link rel=stylesheet href=/css/core.min.ef607fd3ec4a0f4af353d3e9b3a1dc7611964c7c8183a173506541206fada2e3848afb5f470cffc866df3a3cd534c4ea.css integrity=sha384-72B/0+xKD0rzU9Pps6HcdhGWTHyBg6FzUGVBIG+touOEivtfRwz/yGbfOjzVNMTq><link rel=alternate type=application/rss+xml href=/index.xml title=weslack><meta name=twitter:card content="summary"><meta name=twitter:title content><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><img class="site logo" src=/logo.png alt><span class="site name">weslack</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>Categories</a><a class="nav item" href=/tags/>Tags</a><a class="nav item" href=/about/>About</a><a class="nav item" href=https://github%2ecom/weslack target=_blank>GitHub</a></nav></div></span></div><div class="site slogan"><span class=title>CTF Fun and Write Ups</span></div></section><section id=content><ul class="note list"><li class=item><a class=note href=/post/control4-flag-2/><p class="note title">Control4 Flag 2</p><p class="note date">Sat, 24 Apr 2021 12:45:27</p><p class="note content">Challenge Submit the contents of flag.txt, found in USB storage on the device.
Device Control4 Device
Location: 192.168.10.174
Port: A bunch
Exploit: Default SSH credentials
Getting the flag Look through USB devices. didn&rsquo;t find anything.
~# cd /mnt/media/usb/ /mnt/internal/usb# ls Looking for USB devices
~# dmesg | grep usb &lt;6>[42949373.260000] usbcore: registered new interface driver usbfs &lt;6>[42949373.260000] usbcore: registered new interface driver hub &lt;6>[42949373.260000] usbcore: registered new device driver usb &lt;6>[42949373.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/iotvillage/>IotVillage</a><a class=tag href=/tags/control4/>Control4</a><a class=tag href=/tags/default-credentials/>Default Credentials</a></p></li><li class=item><a class=note href=/post/firmware-analysis/><p class="note title">Firmware Analysis</p><p class="note date">Sat, 24 Apr 2021 10:15:52</p><p class="note content">Challenge Who knew embedded web servers ran php natively? And it&rsquo;s easy to read! Or is it?! NOTE find the function mb_version(). Ensure you have a clean text file with ONLY this function (no unreadable/gibberish chars) and use the md5sum as the flag.
Cursory look Looking at the provided file, we extracted it and started looking through the contents of this file. It was a root filesystem for a linux machine.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/iot-village-ctf/>IoT Village CTF</a><a class=tag href=/tags/terramaster/>TerraMaster</a><a class=tag href=/tags/static-analysis/>Static Analysis</a></p></li><li class=item><a class=note href=/post/iotvillage-ctf-scan/><p class="note title">Iotvillage CTF Network Scan</p><p class="note date">Sat, 24 Apr 2021 10:14:52</p><p class="note content">Running tried and true nmap.
sudo nmap 192.168.10.0/24 Output Nmap scan report for 192.168.10.172 Host is up (0.095s latency). Not shown: 998 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap scan report for 192.168.10.173 Host is up (0.096s latency). Not shown: 994 closed ports PORT STATE SERVICE 139/tcp open netbios-ssn 445/tcp open microsoft-ds 548/tcp open afp 5000/tcp open upnp 5001/tcp open commplex-link 8383/tcp open m2mservices Nmap scan report for 192.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/iotvillage/>IoTVillage</a><a class=tag href=/tags/nmap/>nmap</a></p></li><li class=item><a class=note href=/post/mosquitto-2/><p class="note title">Mosquitto Flag 2</p><p class="note date">Sat, 24 Apr 2021 09:41:43</p><p class="note content">Challenge See if you have the patience to scratch the itch; patience is key. Mosquitto bites are so annoying! Except, in this case.. you can become an admin. Connect at: x.x.x.x:1883 using iot:iot Web Portal: http://x.x.x.x
Solve Look at the new Mosquitto server, connecting using the following command
mosquitto_sub -h x.x.x.x -p 1883 -u iot -P iot -t "#" Grab the text that looks like a flag.
Base64 decode the username and password.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/iot-village/>IoT Village</a><a class=tag href=/tags/mosquitto/>Mosquitto</a><a class=tag href=/tags/base64/>Base64</a></p></li><li class=item><a class=note href=/post/black-box-1-flag/><p class="note title">Black Box 1 Flag Writeup</p><p class="note date">Sat, 08 Aug 2020 13:29:43</p><p class="note content">Previous Exploit Doing a search of Control 4 C4-HC250-BL + exploit in Google netted us with the default password used to exploit. http://www.davidsonfamily.ca/discussion-board/topic/logging-into-controller/
Black Box 1 Flag I noticed there was a Black Box Challenge for Control 4, which we previously exploited.
With the password we previously used, we could ssh into the ip to access the directory: /etc/init.d/c4server.
We took the MD5 sum of /etc/init.d/c4server to retrieve the flag.</p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/md5/>md5</a><a class=tag href=/tags/reading-the-instructions/>reading the instructions</a></p></li><li class=item><a class=note href=/post/control4-flag/><p class="note title">Control4 Flag</p><p class="note date">Sat, 08 Aug 2020 13:22:15</p><p class="note content">After doing some research on the control4 product, we found that there is a default root password.
user password root t0talc0ntr0l4! Getting the flag The flag is located on the SD card, so we go look in /mnt/sd/
$ cd /mnt/sd/ $ ls Flag.txt flash lost+found We found the flag, and now we can cat it out and capture it.</p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/control4/>Control4</a><a class=tag href=/tags/></a></p></li><li class=item><a class=note href=/post/setting-up-and-using-tools/><p class="note title">Setting Up and Using Tools</p><p class="note date">Sat, 08 Aug 2020 12:18:30</p><p class="note content">We&rsquo;ve learned how to use couple different tools since we&rsquo;ve started working on the SOHOplessly Broken CTF.
Kali We set up a Vagrant machine to use as a common starting place for each of our machines. It has all of the standard Kali tools installed, as well as some other standard exploit tools.
Requirements Git Vagrant Virtualbox Package Managers It is recommended to use a package manager for installing and updating this software.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/tools/>tools</a></p></li><li class=item><a class=note href=/post/day2-port-scan-update/><p class="note title">Day2 Port Scan Update</p><p class="note date">Sat, 08 Aug 2020 12:16:14</p><p class="note content">After getting connected to the SOHOplesslyBroken VPN, we did an nmap scan of the local IP range for any devices. This as an update to show what flags have already been captured.
nmap 192.168.10.0/24 Control4 Open Source Software Notice url: http://192.168.10.101/
PORT STATE SERVICE 21/tcp closed ftp 22/tcp closed ssh 80/tcp open http Current State: Has not been accessed.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/nmap/>nmap</a><a class=tag href=/tags/devices/>devices</a><a class=tag href=/tags/recon/>recon</a></p></li><li class=item><a class=note href=/post/mosquitto-flag/><p class="note title">Mosquitto Flag</p><p class="note date">Sat, 08 Aug 2020 11:19:07</p><p class="note content">The hint for the flag was.
See if you have the patience to scratch the itch; patience is key. Mosquitto bites are so annoying! Connect at: 209.97.159.20:1883 Creds: iot:iot
We had a feeling that this had something to do with MQTT based off the mosquitto name. Searching for port 1883 confirmed this, as this is a standard port of MQTT.
We installed the mosquitto client using:
sudo apt install -y mosquitto-clients We then connected to the server using:<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/mqtt/>MQTT</a><a class=tag href=/tags/mosquitto/>mosquitto</a><a class=tag href=/tags/protocol/>protocol</a><a class=tag href=/tags/patience/>patience</a></p></li><li class=item><a class=note href=/post/fortinet-flag/><p class="note title">Fortinet Flag</p><p class="note date">Fri, 07 Aug 2020 23:33:58</p><p class="note content">Finding the exploit, we did some google-fu and learned a bit about some of the exploits for the device, but we didn&rsquo;t know which device on the network it was.
We connected to one of the devices and figured out that the favicon of the admin page was Fortinet&rsquo;s logo. From there we started to run some of the exploits. The one that worked for us was https://www.exploit-db.com/exploits/43386
Exploit #!/usr/bin/env python # SSH Backdoor for FortiGate OS Version 4.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/python/>python</a></p></li></ul><div class=pagination><ul><li><a class=active href=/>1</a></li><li><a href=/page/2/>2</a></li></ul></div></section><section id=footer><div class=footer-wrap><p class=copyright>All content is free, unencumbered, and released into the public domain. Do with it what you want. <a href=/LICENSE.txt>Unlicense</a></p><p class=powerby><span>Powered&nbsp;by&nbsp;</span><a href=https://gohugo.io target=_blank>Hugo</a><span>&nbsp;&&nbsp;</span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section></body></html>