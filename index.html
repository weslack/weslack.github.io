<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.83.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>weslack&nbsp;&ndash;&nbsp;CTF Fun and Write Ups</title><link rel=stylesheet href=/css/core.min.5c1ea3b7fda332bb26a6e796e568357472f1c94f2dfd03a45d32c45276f3bca768b134a0b11696b3e3b9f1f7f773fe2a.css integrity=sha384-XB6jt/2jMrsmpueW5Wg1dHLxyU8t/QOkXTLEUnbzvKdosTSgsRaWs+O58ff3c/4q><link rel=alternate type=application/rss+xml href=/index.xml title=weslack><meta name=twitter:card content="summary"><meta name=twitter:title content><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><img class="site logo" src=/logo.png alt><span class="site name">weslack</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>Categories</a><a class="nav item" href=/tags/>Tags</a><a class="nav item" href=/about/>About</a><a class="nav item" href=https://github%2ecom/weslack target=_blank>GitHub</a></nav></div></span></div><div class="site slogan"><span class=title>CTF Fun and Write Ups</span></div></section><section id=content><ul class="note list"><li class=item><a class=note href=/post/creston-airmedia/><p class="note title">Creston Airmedia</p><p class="note date">Sat, 01 May 2021 14:01:13</p><p class="note content">Device Location: 192.168.10.177
Exploits: https://www.exploit-db.com/exploits/46786
ports: 80, 443</p></a><p class="note labels"><a class=category href=/categories/iotvillage/>IoTVillage</a><a class=tag href=/tags/creston/>Creston</a><a class=tag href=/tags/rce/>RCE</a></p></li><li class=item><a class=note href=/post/pihole/><p class="note title">Pihole</p><p class="note date">Sat, 01 May 2021 14:01:03</p><p class="note content">Challenge Submit the contents of flag.txt, found in USB storage on the device.
Device Location: 192.168.10.172
Ports: 22, 80
Admin interface: https://192.168.10.172/admin
Possible Exploit https://frichetten.com/blog/cve-2020-11108-pihole-rce/</p></a><p class="note labels"><a class=category href=/categories/iot-village/>IoT Village</a><a class=tag href=/tags/pihole/>pihole</a></p></li><li class=item><a class=note href=/post/pivot-notes/><p class="note title">Pivot Notes</p><p class="note date">Sat, 01 May 2021 14:00:51</p><p class="note content">When looking through the Control4 machine, we noticed that the IP address range it is on is not in the 192.168.10.0/24 subnet. It is actually in the 172.16.10.0/24 network.
ifconfig eth0 Link encap:Ethernet HWaddr 00:0F:FF:13:D6:1A inet addr:172.16.10.4 Bcast:172.16.10.255 Mask:255.255.255.0 UP BROADCAST NOTRAILERS RUNNING ALLMULTI MULTICAST MTU:1500 Metric:1 RX packets:122800 errors:0 dropped:0 overruns:0 frame:0 TX packets:119369 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:35281332 (33.6 MiB) TX bytes:32480603 (30.9 MiB) Interrupt:13 lo Link encap:Local Loopback inet addr:127.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/pivot/>pivot</a></p></li><li class=item><a class=note href=/post/control4-flag-2/><p class="note title">Control4 Flag 2</p><p class="note date">Sat, 24 Apr 2021 12:45:27</p><p class="note content">Challenge Submit the contents of flag.txt, found in USB storage on the device.
Device Control4 Device
Location: 192.168.10.174
Port: A bunch
Exploit: Default SSH credentials
Getting the flag Look through USB devices. didn&rsquo;t find anything.
~# cd /mnt/media/usb/ /mnt/internal/usb# ls Looking for USB devices
~# dmesg | grep usb &lt;6>[42949373.260000] usbcore: registered new interface driver usbfs &lt;6>[42949373.260000] usbcore: registered new interface driver hub &lt;6>[42949373.260000] usbcore: registered new device driver usb &lt;6>[42949373.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/iotvillage/>IotVillage</a><a class=tag href=/tags/control4/>Control4</a><a class=tag href=/tags/default-credentials/>Default Credentials</a></p></li><li class=item><a class=note href=/post/firmware-analysis/><p class="note title">Firmware Analysis</p><p class="note date">Sat, 24 Apr 2021 10:15:52</p><p class="note content">Challenge Who knew embedded web servers ran php natively? And it&rsquo;s easy to read! Or is it?! NOTE find the function mb_version(). Ensure you have a clean text file with ONLY this function (no unreadable/gibberish chars) and use the md5sum as the flag.
Cursory look Looking at the provided file, we extracted it and started looking through the contents of this file. It was a root filesystem for a linux machine.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/iot-village-ctf/>IoT Village CTF</a><a class=tag href=/tags/terramaster/>TerraMaster</a><a class=tag href=/tags/static-analysis/>Static Analysis</a></p></li><li class=item><a class=note href=/post/iotvillage-ctf-scan/><p class="note title">Iotvillage CTF Network Scan</p><p class="note date">Sat, 24 Apr 2021 10:14:52</p><p class="note content">Running tried and true nmap.
sudo nmap 192.168.10.0/24 Output Nmap scan report for 192.168.10.172 Host is up (0.095s latency). Not shown: 998 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap scan report for 192.168.10.173 Host is up (0.096s latency). Not shown: 994 closed ports PORT STATE SERVICE 139/tcp open netbios-ssn 445/tcp open microsoft-ds 548/tcp open afp 5000/tcp open upnp 5001/tcp open commplex-link 8383/tcp open m2mservices Nmap scan report for 192.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/iotvillage/>IoTVillage</a><a class=tag href=/tags/nmap/>nmap</a></p></li><li class=item><a class=note href=/post/mosquitto-2/><p class="note title">Mosquitto Flag 2</p><p class="note date">Sat, 24 Apr 2021 09:41:43</p><p class="note content">Challenge See if you have the patience to scratch the itch; patience is key. Mosquitto bites are so annoying! Except, in this case.. you can become an admin. Connect at: x.x.x.x:1883 using iot:iot Web Portal: http://x.x.x.x
Solve Look at the new Mosquitto server, connecting using the following command
mosquitto_sub -h x.x.x.x -p 1883 -u iot -P iot -t "#" Grab the text that looks like a flag.
Base64 decode the username and password.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/iot-village/>IoT Village</a><a class=tag href=/tags/mosquitto/>Mosquitto</a><a class=tag href=/tags/base64/>Base64</a></p></li><li class=item><a class=note href=/post/black-box-1-flag/><p class="note title">Black Box 1 Flag Writeup</p><p class="note date">Sat, 08 Aug 2020 13:29:43</p><p class="note content">Previous Exploit Doing a search of Control 4 C4-HC250-BL + exploit in Google netted us with the default password used to exploit. http://www.davidsonfamily.ca/discussion-board/topic/logging-into-controller/
Black Box 1 Flag I noticed there was a Black Box Challenge for Control 4, which we previously exploited.
With the password we previously used, we could ssh into the ip to access the directory: /etc/init.d/c4server.
We took the MD5 sum of /etc/init.d/c4server to retrieve the flag.</p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/md5/>md5</a><a class=tag href=/tags/reading-the-instructions/>reading the instructions</a></p></li><li class=item><a class=note href=/post/control4-flag/><p class="note title">Control4 Flag</p><p class="note date">Sat, 08 Aug 2020 13:22:15</p><p class="note content">After doing some research on the control4 product, we found that there is a default root password.
user password root t0talc0ntr0l4! Getting the flag The flag is located on the SD card, so we go look in /mnt/sd/
$ cd /mnt/sd/ $ ls Flag.txt flash lost+found We found the flag, and now we can cat it out and capture it.</p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/control4/>Control4</a><a class=tag href=/tags/></a></p></li><li class=item><a class=note href=/post/setting-up-and-using-tools/><p class="note title">Setting Up and Using Tools</p><p class="note date">Sat, 08 Aug 2020 12:18:30</p><p class="note content">We&rsquo;ve learned how to use couple different tools since we&rsquo;ve started working on the SOHOplessly Broken CTF.
Kali We set up a Vagrant machine to use as a common starting place for each of our machines. It has all of the standard Kali tools installed, as well as some other standard exploit tools.
Requirements Git Vagrant Virtualbox Package Managers It is recommended to use a package manager for installing and updating this software.<span class=mldr>&mldr;</span></p></a><p class="note labels"><a class=category href=/categories/sohoplessly-broken/>SOHOplessly Broken</a><a class=tag href=/tags/tools/>tools</a></p></li></ul><div class=pagination><ul><li><a class=active href=/>1</a></li><li><a href=/page/2/>2</a></li></ul></div></section><section id=footer><div class=footer-wrap><p class=copyright>All content is free, unencumbered, and released into the public domain. Do with it what you want. <a href=/LICENSE.txt>Unlicense</a></p><p class=powerby><span>Powered&nbsp;by&nbsp;</span><a href=https://gohugo.io target=_blank>Hugo</a><span>&nbsp;&&nbsp;</span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section></body></html>